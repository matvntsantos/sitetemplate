<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>VDESI — Portfólio</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <!-- SEO & Open Graph -->
  <meta property="og:title" content="VDESI — Portfólio de Design">
  <meta property="og:description" content="Design Gráfico, UI e Branding. Transformando ideias em realidade visual.">
  <meta property="og:image" content="https://seusite.com/profilepicpng.png"> <!-- Substitua pela URL real quando publicar -->
  <meta property="og:type" content="website">
  <!-- Added font weight 500 for Inter Medium -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/feather-icons"></script>
  <style>
    :root{
      --bg: #ffffff;      /* cor de fundo */
      --fg: #0a0a0a;      /* cor do texto */
      --muted: #525252;    /* texto secundário */
      --accent: #0a0a0a;    /* cor de destaque */
      --box-w: min(560px, 45vw);
    }
    body.dark-mode {
      --bg: #141414; /* Um pouco mais claro que o preto total */
      --fg: #ffffff;
      --muted: #a3a3a3;
      --accent: #ffffff;
    }
    *{box-sizing:border-box; scroll-behavior: smooth;}
    html,body{height:100%}
    html {
        /* Hide scrollbar for Firefox */
        scrollbar-width: none;
        /* Hide scrollbar for IE, Edge */
        -ms-overflow-style: none;
    }
    /* Hide scrollbar for Chrome, Safari and Opera */
    html::-webkit-scrollbar {
        display: none;
    }
    body{
      margin:0; font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
      background-color: var(--bg); /* Cor de fundo principal */
      color: var(--fg);
      /* Changed to allow scrolling once preloader is gone */
      overflow:hidden;
      cursor: none; /* Hide the default cursor */
    }

    ::selection {
        background: var(--fg);
        color: var(--bg);
    }

    /* --- Custom Cursor Styles --- */
    #custom-cursor {
        position: fixed;
        width: 20px;
        height: 20px;
        background-color: #ffffff; /* Branco para funcionar o difference */
        border-radius: 50%;
        pointer-events: none;
        mix-blend-mode: difference; /* Inverte as cores do fundo */
        /* Transform is now fully handled by JS for the lag effect */
        transition: background-color 0.3s ease-out, transform 0.3s ease-out;
        z-index: 20000; /* Z-index aumentado para ficar acima de tudo */
        opacity: 1; /* Opacidade total para o efeito de inversão ficar nítido */
        left: 0;
        top: 0;
    }
    #custom-cursor.hover {
        transform: scale(1.5);
        /* background-color: var(--accent); Removido para manter a inversão */
    }
    /* Remove cursor personalizado no mobile */
    @media (hover: none) and (pointer: coarse) {
        #custom-cursor { display: none; }
        body { cursor: auto; }
        a, .grid-item-link { cursor: pointer; }
    }
    a, .grid-item-link {
        cursor: none;
    }


    /* --- NEW Pre-loader Styles --- */
    #preloader {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: #000;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        transition: opacity 1.5s ease-in-out;
    }

    .text-container {
        position: relative;
        width: 80vw;
        text-align: center;
    }

    .loader-text {
        font-family: 'Courier New', Courier, monospace; /* Fonte mais técnica/underground */
        font-size: clamp(1.5rem, 5vw, 3.5rem);
        font-weight: 800;
        color: white;
        text-transform: uppercase;
        position: relative;
        display: inline-block;
    }
    
    /* Glitch Effect Styles */
    .loader-text.glitch::before,
    .loader-text.glitch::after {
        content: attr(data-text);
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #000;
    }
    .loader-text.glitch::before {
        left: 2px;
        text-shadow: -2px 0 #ff00c1;
        clip: rect(44px, 450px, 56px, 0);
        animation: glitch-anim 5s infinite linear alternate-reverse;
    }
    .loader-text.glitch::after {
        left: -2px;
        text-shadow: -2px 0 #00fff9;
        clip: rect(44px, 450px, 56px, 0);
        animation: glitch-anim 5s infinite linear alternate-reverse;
    }
    @keyframes glitch-anim {
        0% { clip: rect(30px, 9999px, 10px, 0); }
        5% { clip: rect(80px, 9999px, 90px, 0); }
        100% { clip: rect(10px, 9999px, 60px, 0); }
    }
    /* --- End of Pre-loader Styles --- */


    /* --- Hero Section (Old Main Content) Styles --- */
    #hero-section {
        width: 100%;
        height: 100vh; /* Full viewport height */
        display: flex;
        justify-content: center;
        align-items: center;
        position: sticky; /* Makes it stick while scrolling */
        top: 0;
        z-index: 1; /* Behind the services section */
        background-color: transparent;
    }

    .wrap{
      position:relative;
      width: 100%;
      padding: 0 15vw;
      height: min(720px, 88vh);
      display:flex;
      align-items:center; justify-content:center;
    }

    .bg-logo{
      position:absolute; inset:0; pointer-events:none; z-index:0;
      display:grid; place-items:center;
      overflow: hidden;
    }
    .bg-logo img{
      width: 110vw;
      max-width: 1600px;
      min-width: 600px;
      opacity: .03;
      filter: grayscale(100%);
      transform: translate(2%, -4%);
      transition: opacity 0.3s ease;
    }

    #hero-section .grid{
      position:relative; z-index:1;
      display:flex;
      justify-content: space-between;
      align-items: center;
      width:100%;
    }

    .box{
      width: var(--box-w);
      min-height: 320px;
      background: transparent; /* Removido fundo para evitar quadrado claro no dark mode */
      border: none;
      border-radius: 16px;
      display:flex; flex-direction:column; gap: 24px;
      backdrop-filter: saturate(105%);
      opacity: 0;
      transform: translateY(40px);
      transition: transform 0.8s cubic-bezier(.2,.8,.2,1), opacity 0.8s ease-out;
    }
    
    .grid.visible .box {
        opacity: 1;
        transform: translateY(0);
    }
    
    .grid.visible .box:nth-child(2) {
        transition-delay: 0.15s;
    }


    .brand{
      display:flex; flex-direction:column; gap: 24px; align-items:flex-start;
    }
    /* --- Draggable Logo Styles --- */
    .logo-wrapper {
        position: relative;
        display: inline-block;
        cursor: none; /* Mantém o cursor personalizado */
        user-select: none;
        touch-action: none; /* Prevent scrolling on mobile while dragging */
    }
    .logo-wrapper.active {
        outline: 2px dashed var(--accent);
        cursor: none;
    }
    .logo-wrapper .handle {
        position: absolute;
        width: 10px;
        height: 10px;
        background-color: #fff;
        border: 2px solid #000;
        border-radius: 50%;
        display: none;
        z-index: 10;
    }
    .logo-wrapper.active .handle { display: block; }
    .logo-wrapper .handle.tl { top: -6px; left: -6px; }
    .logo-wrapper .handle.tr { top: -6px; right: -6px; }
    .logo-wrapper .handle.bl { bottom: -6px; left: -6px; }
    .logo-wrapper .handle.br { bottom: -6px; right: -6px; }

    .brand-logo{
      height: 88px;
      width:auto; display:block;
      object-fit: contain;
    }
    .taglines{
        font-weight:800; 
        letter-spacing: .5px; 
        line-height:1.1;
        font-size: clamp(1.8rem, 3.5vw, 2.5rem);
    }
    .taglines span{
        display:block;
        opacity: 0;
        transform: translateY(15px);
        filter: blur(10px);
        transition: opacity 0.8s ease, transform 0.8s ease, filter 0.8s ease;
    }
    .grid.visible .taglines span { opacity: 1; transform: translateY(0); filter: blur(0); }
    .grid.visible .taglines span:nth-child(1) { transition-delay: 0.3s; }
    .grid.visible .taglines span:nth-child(2) { transition-delay: 0.5s; }

    nav{
      display:flex; flex-direction:column; gap: 14px; align-items:flex-end;
    }
    .nav-title{display: none;}
    .menu{
      display:flex; flex-direction:column; gap:12px; width:100%;
      align-items: flex-end;
    }
    /* Botão de tema discreto no menu */
    #hero-theme-toggle {
        color: var(--fg);
        margin-bottom: 10px;
        opacity: 0.6;
    }
    #hero-theme-toggle:hover { opacity: 1; }
    .menu a{
      display:block; width: auto;
      text-decoration:none; color:var(--fg);
      font-weight:500; 
      font-size: 1.1rem;
      padding:12px 0; border-bottom:none;
      text-align: right;
      opacity: 0;
      transform: translateX(20px);
      transition: transform .2s cubic-bezier(.2,.8,.2,1), opacity .2s;
    }
    .grid.visible .menu a {
        opacity: 1;
        transform: translateX(0);
        transition: opacity 0.5s ease, transform 0.5s cubic-bezier(.2,.8,.2,1);
    }
    .grid.visible .menu a:nth-child(1) { transition-delay: 0.4s; }
    .grid.visible .menu a:nth-child(2) { transition-delay: 0.5s; }
    .grid.visible .menu a:nth-child(3) { transition-delay: 0.6s; }
    .menu a:hover{transform: translateX(-6px); transition-delay: 0s;}

    .scroll-down {
        position: absolute;
        bottom: 4vh;
        left: 50%;
        transform: translateX(-50%);
        z-index: 10;
        opacity: 0;
        transition: opacity 0.6s ease-in-out 0.8s;
    }
    .scroll-down.visible {
        opacity: 1;
    }
    .scroll-down a { display: block; }
    .scroll-down svg {
        width: 28px;
        height: auto;
        animation: bounce 2s infinite cubic-bezier(.4,0,.6,1);
    }
    @keyframes bounce {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-10px); }
    }

    /* --- Shared Section Title Style --- */
    .section-title {
        text-align: center;
        font-weight: 800;
        letter-spacing: 0.15em;
        text-transform: uppercase;
        margin-bottom: 35px;
        font-size: 1.125rem;
    }

    /* --- Marquee Section --- */
    .marquee-container {
        width: 100%;
        overflow: hidden;
        background: var(--fg);
        color: var(--bg);
        padding: 15px 0;
        white-space: nowrap;
        position: relative;
        z-index: 2;
    }
    .marquee-content {
        display: inline-block;
        /* Animation handled by JS now for interactivity */
        will-change: transform;
        font-weight: 700;
        text-transform: uppercase;
        font-size: clamp(1rem, 4vw, 1.2rem); /* Responsivo */
        letter-spacing: 2px;
    }

    /* --- Services Section --- */
    #servicos {
        position: relative; /* Needed for z-index to work */
        z-index: 2; /* Sits on top of the hero section */
        background-color: var(--bg);
        color: var(--fg);
        padding: 40px 24px 80px;
    }
    #servicos .page-content {
        width: 1080px;
        max-width: 100%;
        margin: 0 auto;
        box-sizing: border-box;
    }
    #servicos .grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        column-gap: 48px;
        row-gap: 10vh; /* Space between rows */
        align-items: start;
    }
    #servicos .card {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        transition: transform 0.4s cubic-bezier(.2,.8,.2,1);
    }
    #servicos .card:hover {
        transform: translateY(-12px);
    }
    #servicos .thumb {
        width: 100%;
        aspect-ratio: 586 / 684;
        border-radius: 12px;
        background: #ddd;
        overflow: hidden;
        position: relative; /* Added for positioning context */
    }
    #servicos .thumb > img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
        transition: transform 0.5s cubic-bezier(.2,.8,.2,1);
    }
    #servicos .thumb:hover > img {
        transform: scale(1.05);
    }
    #servicos .caption {
        position: static; /* Reverted positioning */
        color: var(--fg);
        text-shadow: none;
        margin-top: 10px;
        letter-spacing: 0.18em;
        text-transform: lowercase;
        font-size: 14px;
        line-height: 1.25;
        width: 100%;
        transition: transform 0.3s ease, color 0.3s ease, opacity 0.3s ease;
    }
    #servicos .card:hover .caption {
        transform: translateX(8px);
        color: var(--accent);
    }
    /* Pushes the right column (even items) down */
    #servicos .card:nth-child(even) { 
        margin-top: 10vh; 
    }
    #servicos .soft { border-radius: 12px; }

    /* --- Destaques Section --- */
    #destaques {
        position: relative;
        z-index: 3;
        background-color: var(--bg);
    }
    #destaques .header {
        text-align: center;
        padding: 40px 20px;
        color: var(--fg);
    }
    #destaques .header p {
        font-weight: 500; /* Inter Medium */
        font-size: 16px;
        color: var(--fg);
        margin: 0;
        padding-top: 15px;
        position: relative;
    }
    #destaques .header p::before {
        content: '';
        display: block;
        width: 6px;
        height: 6px;
        background-color: var(--fg);
        border-radius: 50%;
        position: absolute;
        top: 0;
        left: 50%;
        transform: translateX(-50%);
    }
    #destaques .portfolio-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        width: 100%;
        gap: 0;
        position: relative;
        background-color: var(--muted); /* Fills sub-pixel gaps */
    }
    #destaques .grid-item-link {
        display: block;
        text-decoration: none;
    }
    #destaques .grid-item {
        height: 720px; /* Increased height */
        background-color: #ccc;
        box-sizing: border-box;
        padding: 40px;
        overflow: hidden;
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
        transition: transform 0.4s cubic-bezier(.2,.8,.2,1), box-shadow 0.4s cubic-bezier(.2,.8,.2,1);
    }
    #destaques .grid-item:hover {
        transform: translateY(-10px) scale(1.02);
        box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        z-index: 10;
    }
    /* Checkerboard effect */
    #destaques .grid-item:nth-child(even) {
        background-color: #bbb; /* Slightly darker color */
    }
    /* --- NEW: Portfolio Image Styles --- */
    .portfolio-image {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover; /* This is key! */
        z-index: 1;
        filter: grayscale(100%) contrast(110%);
        transition: filter 0.4s ease;
    }
    #destaques .image-placeholder-text {
        display: none; /* Hide the old text placeholder */
    }
    #destaques .item-title-block {
        color: #FFFFFF; /* Changed to white for better contrast on images */
        text-shadow: 0 2px 10px rgba(0,0,0,0.5); /* Added text shadow */
        position: absolute; /* Posiciona sobre a "imagem" */
        left: 40px;
        bottom: 40px;
        z-index: 2; /* Ensure title is above the image */
        transition: transform 0.4s cubic-bezier(.2,.8,.2,1);
    }
    #destaques .grid-item:hover .portfolio-image {
        filter: grayscale(0%) contrast(100%);
    }
    #destaques .grid-item:hover .item-title-block {
        transform: translateX(15px) translateY(-5px);
    }
    #destaques .item-title-block h2 {
        font-family: 'Inter', sans-serif;
        font-weight: 800; /* Inter Extra Bold */
        font-size: 48px;
        line-height: 1.1;
        margin: 0;
        text-transform: uppercase;
        transition: letter-spacing 0.4s ease;
    }
    #destaques .grid-item:hover .item-title-block h2 {
        letter-spacing: 3px;
    }
    #destaques .item-title-block p {
        font-family: 'Inter', sans-serif;
        font-weight: 500; /* Inter Medium */
        font-size: 20px;
        margin: 10px 0 0 0;
    }

    /* --- Sobre/Contato Section --- */
    #sobre-contato {
        position: relative;
        z-index: 4;
        background-color: var(--bg);
    }
    #sobre-contato .container {
        width: 100%;
        max-width: 1080px;
        margin: 0 auto;
        background-color: var(--bg);
        background-repeat: no-repeat;
        background-position: center center;
        background-size: contain;
    }
    #sobre-contato .content {
        max-width: 580px;
        margin: 0 auto;
        padding: 120px 20px;
        text-align: center;
    }
    #sobre-contato section {
        margin-bottom: 90px;
    }
    #sobre-contato p {
        font-size: 1.1rem;
        font-weight: 400;
        line-height: 1.8;
        margin-bottom: 1.5em;
    }
    #sobre-contato .about p:last-of-type {
        margin-bottom: 0;
    }
    #sobre-contato .contact .social-icons {
        margin-bottom: 25px;
    }
    #sobre-contato .contact .social-icons a {
        color: var(--fg);
        margin: 0 12px;
        text-decoration: none;
    }
    #sobre-contato .contact .social-icons i {
        width: 28px;
        height: 28px;
    }
    #sobre-contato .contact .email {
        font-size: 1.1rem;
        color: var(--fg);
        text-decoration: none;
        letter-spacing: 0.05em;
    }

    /* --- Footer --- */
    footer {
        position: relative;
        z-index: 5;
        width: 100%;
        background-color: #111;
        color: #888;
        padding: 60px 20px 40px;
        text-align: center;
    }
    footer .back-to-top {
        margin-bottom: 30px;
    }
    footer .back-to-top a {
        color: #E0E0E0;
        text-decoration: none;
    }
    footer .back-to-top i {
        width: 32px;
        height: 32px;
    }
    footer .credits {
        font-size: 0.875rem;
        color: #adadad;
    }
    footer .credits a {
        color: #adadad;
        text-decoration: underline;
        font-weight: 700;
    }

    /* --- Dark Mode Toggle --- */
    .theme-toggle {
        margin-top: 20px;
        display: inline-block;
        cursor: pointer;
        padding: 10px;
        border: 1px solid #333;
        border-radius: 50px;
        background: transparent;
        color: #888;
        transition: all 0.3s ease;
    }
    .theme-toggle:hover {
        background: #333;
        color: #fff;
    }

    /* --- Noise Texture --- */
    .noise-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 19999; /* Acima do modal, abaixo do cursor */
        opacity: 0.03; /* Reduzido para ficar mais sutil */
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
    }
    
    /* --- Theme Transition Overlay --- */
    #theme-transition-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: #000;
        z-index: 21000; /* Acima de tudo, inclusive cursor */
        display: flex;
        justify-content: center;
        align-items: center;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.5s ease;
    }
    #theme-transition-overlay.active { opacity: 1; pointer-events: auto; }
    .theme-loader { width: 40px; height: 40px; background-color: #fff; animation: spin-square 1s infinite linear; }
    @keyframes spin-square { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    /* --- Case Study Modal (Fullscreen Slider) --- */
    #case-study-modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(255, 255, 255, 0.8); /* Fundo semi-transparente */
        backdrop-filter: blur(15px); /* Desfoque do fundo */
        z-index: 10002;
        display: none;
        opacity: 0;
        transition: opacity 0.5s ease;
        flex-direction: column;
    }
    #case-study-modal.active {
        display: flex;
        opacity: 1;
    }
    body.dark-mode #case-study-modal {
        background: rgba(10, 10, 10, 0.8);
    }
    .modal-header {
        padding: 20px;
        display: flex;
        justify-content: flex-end;
        z-index: 10;
    }
    .close-modal {
        background: none;
        border: none;
        color: var(--fg);
        cursor: pointer;
        width: 48px;
        height: 48px;
        border: 2px solid var(--fg);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
    }
    .close-modal:hover {
        background: var(--fg);
        color: var(--bg);
        transform: rotate(90deg);
    }
    .modal-slider {
        flex: 1;
        display: flex;
        overflow-x: auto;
        scroll-snap-type: x mandatory;
        scroll-behavior: smooth;
        height: 100%;
        align-items: center;
    }
    /* Hide scrollbar in modal */
    .modal-slider::-webkit-scrollbar { display: none; }
    .modal-slider { -ms-overflow-style: none; scrollbar-width: none; }

    .slide {
        min-width: 100vw;
        height: 100%;
        scroll-snap-align: center;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 40px;
    }
    .slide img {
        max-width: 100%;
        max-height: 100%;
        object-fit: contain;
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        transform: scale(0.9);
        opacity: 0;
        transition: transform 0.8s cubic-bezier(0.2, 0.8, 0.2, 1), opacity 0.8s ease;
    }
    .slide.active img {
        transform: scale(1);
        opacity: 1;
    }

    /* Modal Navigation Buttons */
    .modal-nav-btn {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        background: rgba(255,255,255,0.05);
        backdrop-filter: blur(5px);
        border: 2px solid var(--fg);
        border-radius: 50%;
        width: 64px;
        height: 64px;
        color: var(--fg);
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: none; /* Mantém cursor personalizado */
        z-index: 20;
        transition: transform 0.3s ease, opacity 0.3s ease;
    }
    .modal-nav-btn:hover {
        transform: translateY(-50%) scale(1.1);
        background: var(--fg);
        color: var(--bg);
    }
    .modal-prev { left: 0; }
    .modal-next { right: 0; }
    .modal-prev { left: 20px; }
    .modal-next { right: 20px; }

    /* Slide Caption (Street/Underground Style) */
    .slide-caption {
        position: absolute;
        bottom: 60px;
        left: 60px;
        max-width: 400px;
        z-index: 10;
        pointer-events: none;
        text-align: left;
    }
    .slide-caption h3 {
        font-size: 2.5rem;
        font-weight: 800;
        text-transform: uppercase;
        background: var(--fg);
        color: var(--bg);
        padding: 5px 15px;
        display: inline-block;
        margin: 0 0 10px 0;
        transform: rotate(-1deg);
        transform-origin: left bottom;
        
        /* Estado Oculto (Saída) */
        opacity: 0;
        transform: translateY(50px) rotate(10deg) scale(0.8);
        transition: opacity 0.3s ease, transform 0.3s ease; /* Saída rápida */
    }
    .slide-caption p {
        font-size: 1rem;
        font-weight: 600;
        background: var(--bg);
        color: var(--fg);
        padding: 10px 15px;
        display: inline-block;
        margin: 0;
        border: 2px solid var(--fg);
        transform: rotate(1deg);
        
        /* Estado Oculto (Saída) */
        opacity: 0;
        transform: translateY(50px) rotate(-10deg) scale(0.8);
        transition: opacity 0.3s ease, transform 0.3s ease; /* Saída rápida */
    }
    .slide.active .slide-caption h3 {
        opacity: 1;
        transform: translateY(0) rotate(-1deg) scale(1);
        transition: opacity 0.6s ease 0.3s, transform 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) 0.3s; /* Entrada elástica com delay */
    }
    .slide.active .slide-caption p {
        opacity: 1;
        transform: translateY(0) rotate(1deg) scale(1);
        transition: opacity 0.6s ease 0.4s, transform 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) 0.4s; /* Entrada elástica com delay */
    }
    
    @media (max-width: 768px) {
        .slide-caption { bottom: 80px; left: 20px; right: 20px; }
        .slide-caption h3 { font-size: 1.5rem; }
        .modal-nav-btn { width: 48px; height: 48px; }
        .modal-prev { left: 10px; }
        .modal-next { right: 10px; }
    }

    /* --- Extra Animations --- */
    @keyframes float {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-10px); }
    }
    
    .brand-logo.floating {
        animation: float 4s ease-in-out infinite;
    }

    .menu a {
        position: relative;
    }
    .menu a::after {
        content: '';
        position: absolute;
        bottom: 12px;
        right: 0;
        width: 0;
        height: 1px;
        background-color: var(--fg);
        transition: width 0.3s ease;
    }
    .menu a:hover::after {
        width: 100%;
    }

    #sobre-contato .social-icons a {
        display: inline-block;
        opacity: 0;
        transform: translateY(20px);
        transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275), opacity 0.5s ease;
    }
    #sobre-contato .contact.is-visible .social-icons a {
        opacity: 1;
        transform: translateY(0);
    }
    #sobre-contato .contact.is-visible .social-icons a:nth-child(1) { transition-delay: 0.1s; }
    #sobre-contato .contact.is-visible .social-icons a:nth-child(2) { transition-delay: 0.2s; }
    #sobre-contato .social-icons a:hover {
        transform: scale(1.2);
        transition-delay: 0s;
    }

    .back-to-top a {
        display: inline-block;
        transition: transform 0.3s ease;
        animation: float 3s ease-in-out infinite;
    }
    .back-to-top a:hover {
        transform: translateY(-5px);
    }

    /* --- Scroll Reveal Styles --- */
    .revealable {
        opacity: 0;
        transform: translateY(50px) rotate(1deg);
        transition: opacity 0.8s cubic-bezier(.2,.8,.2,1), transform 0.8s cubic-bezier(.2,.8,.2,1);
    }
    .is-visible {
        opacity: 1;
        transform: translateY(0) rotate(0);
    }
    /* Staggered delay for cards */
    #servicos .card.is-visible:nth-of-type(1) { transition-delay: 0.1s; }
    #servicos .card.is-visible:nth-of-type(2) { transition-delay: 0.25s; }
    #servicos .card.is-visible:nth-of-type(3) { transition-delay: 0.1s; }
    #servicos .card.is-visible:nth-of-type(4) { transition-delay: 0.25s; }
    /* Staggered delay for grid items */
    #destaques .grid-item.is-visible:nth-of-type(1) { transition-delay: 0.1s; }
    #destaques .grid-item.is-visible:nth-of-type(2) { transition-delay: 0.2s; }
    #destaques .grid-item.is-visible:nth-of-type(3) { transition-delay: 0.3s; }
    #destaques .grid-item.is-visible:nth-of-type(4) { transition-delay: 0.1s; }
    #destaques .grid-item.is-visible:nth-of-type(5) { transition-delay: 0.2s; }
    #destaques .grid-item.is-visible:nth-of-type(6) { transition-delay: 0.3s; }

    /* --- Initial Hidden State for Preloading --- */
    .content-hidden {
        opacity: 0;
        pointer-events: none;
    }

    @media (max-width: 860px){
      .wrap{
          height:auto; 
          padding: 12vh 8vw;
          flex-direction: column;
          gap: 48px;
      }
      #hero-section .grid{
          flex-direction:column;
          justify-content: center;
          gap: 48px;
          width: 100%;
      }
      .box{
          width: 100%;
          min-height: auto;
          align-items: center;
          text-align: center;
      }
      .brand {
          align-items: center;
      }
      .taglines {
          font-size: 1.5rem;
      }
      nav, .menu { 
          align-items: center; 
      }
      .menu a { 
          text-align: center; 
      }
      .menu a:hover{transform: translateX(0)}
      .bg-logo img{width: 150vw; transform: translate(0, -4%)}

      #servicos .grid {
        grid-template-columns: 1fr;
        gap: 48px;
      }
      #servicos .card:nth-child(n) {
        margin-top: 0; /* Remove all stagger on mobile */
      }
      #destaques .portfolio-grid {
        grid-template-columns: 1fr;
      }
      #destaques .grid-item:nth-child(n) {
          margin-left: 0;
          width: 100%;
          z-index: auto;
      }
    }
  </style>
</head>
<body>
  <div id="custom-cursor"></div>
  
  <!-- Noise Texture Overlay -->
  <div class="noise-overlay"></div>

  <!-- Theme Transition Overlay -->
  <div id="theme-transition-overlay">
      <div class="theme-loader"></div>
  </div>

  <div id="preloader">
    <div class="text-container">
        <div class="loader-text" data-text="DÊ VIDA ÀS SUAS IDEIAS">
            <!-- Text injected via JS -->
        </div>
    </div>
  </div>

  <main id="hero-section" class="content-hidden">
      <div class="wrap">
        <div class="bg-logo" aria-hidden="true">
          <img src="/profilepicpng.png" alt="Background Logo" onerror="this.onerror=null;this.src='https://placehold.co/1600x1200/e0e0e0/333333?text=Image+Not+Found';" />
        </div>

        <div class="grid">
          <section class="box" style="justify-content:center">
            <div class="brand">
              <div id="draggable-logo" class="logo-wrapper">
                  <img class="brand-logo" src="/profilepicpng.png" draggable="false" alt="Logo" onerror="this.onerror=null;this.src='https://placehold.co/300x88/e0e0e0/333333?text=Image+Not+Found';" />
                  <div class="handle tl"></div>
                  <div class="handle tr"></div>
                  <div class="handle bl"></div>
                  <div class="handle br"></div>
              </div>
              <div class="taglines" aria-label="serviços destacados">
                <span>BANNERS. FLYERS.</span>
                <span>POSTS. E MAIS.</span>
              </div>
            </div>
          </section>

          <section class="box" style="justify-content:center">
            <nav aria-label="Navegação principal">
              <div class="menu">
                <a href="#" id="hero-theme-toggle" aria-label="Alternar tema">
                    <i data-feather="moon"></i>
                </a>
                <a href="#servicos">serviços</a>
                <a href="#sobre">sobre</a>
                <a href="#contato">contato</a>
              </div>
            </nav>
          </section>
        </div>
      </div>
      
      <div class="scroll-down" aria-hidden="true">
        <a href="#servicos">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="5" y="2" width="14" height="20" rx="7"/>
                <path d="M12 6v4"/>
            </svg>
        </a>
      </div>
  </main>

  <!-- Marquee Section -->
  <div class="marquee-container">
      <div class="marquee-content">
          <!-- Content duplicated for JS logic -->
          <span>AVAILABLE FOR FREELANCE • UI DESIGN • BRANDING • </span>
      </div>
  </div>

  <section id="servicos" class="content-hidden">
    <div class="page-content">
        <h2 id="sec-servicos" class="section-title revealable">SERVIÇOS</h2>

        <div class="grid">
            <!-- 1 -->
            <article class="card revealable">
                <div class="thumb soft">
                    <img src="postexemplo.jpg" alt="Exemplo de arte promocional">
                </div>
                <p class="caption">artes<br>promocionais</p>
            </article>

            <!-- 2 -->
            <article class="card revealable">
                <div class="thumb soft">
                    <img src="logotipoeoutro.png" alt="Exemplo de logotipo">
                </div>
                <p class="caption">logotipos<br>e outros</p>
            </article>

            <!-- 3 -->
            <article class="card revealable">
                <div class="thumb soft">
                    <img src="https://placehold.co/586x684/d1d1d1/333?text=Convite+Digital" alt="Exemplo de convite digital">
                </div>
                <p class="caption">convites<br>digitais</p>
            </article>

            <!-- 4 -->
            <article class="card revealable">
                <div class="thumb soft">
                    <img src="identidadevisual-exemplos.jpg" alt="Exemplo de identidade visual">
                </div>
                <p class="caption">identidades<br>visuais</p>
            </article>
        </div>
    </div>
  </section>

  <section id="destaques" class="content-hidden">
    <header class="header revealable">
        <p>alguns destaques... clique para ver o projeto completo</p>
    </header>

    <main class="portfolio-grid">

        <a href="#" class="grid-item-link" data-project="1">
            <div class="grid-item revealable">
                <div class="grid-item-content">
                    <!-- IMAGE ADDED HERE -->
                    <img class="portfolio-image" src="psot1.png" alt="Imagem do projeto de arte promocional">
                    <div class="item-title-block">
                        <h2>ARTE<br>PROMO<br>CIONAL</h2>
                        <p>2025</p>
                    </div>
                </div>
            </div>
        </a>

        <a href="#" class="grid-item-link" data-project="2">
            <div class="grid-item revealable">
                <div class="grid-item-content">
                    <!-- IMAGE ADDED HERE -->
                    <img class="portfolio-image" src="mockup1.png" alt="Imagem do projeto de identidade visual">
                    <div class="item-title-block">
                        <h2>IDENTI<br>DADE<br>VISUAL</h2>
                        <p>2025</p>
                    </div>
                </div>
            </div>
        </a>

        <a href="#" class="grid-item-link" data-project="3">
            <div class="grid-item revealable">
                <div class="grid-item-content">
                    <!-- IMAGE ADDED HERE -->
                    <img class="portfolio-image" src="imagem33.png" alt="Imagem do projeto de logotipo">
                    <div class="item-title-block">
                        <h2>LOGO<br>TI<br>PO</h2>
                        <p>2025</p>
                    </div>
                </div>
            </div>
        </a>

        <a href="#" class="grid-item-link" data-project="4">
            <div class="grid-item revealable">
                <div class="grid-item-content">
                    <!-- IMAGE ADDED HERE -->
                    <img class="portfolio-image" src="https://placehold.co/800x800/444/fff?text=Projeto+4" alt="Imagem do projeto de identidade visual 3">
                    <div class="item-title-block">
                        <h2>IDENTI<br>DADE<br>VISUAL</h2>
                        <p>2025</p>
                    </div>
                </div>
            </div>
        </a>

        <a href="#" class="grid-item-link" data-project="5">
            <div class="grid-item revealable">
                <div class="grid-item-content">
                    <!-- IMAGE ADDED HERE -->
                    <img class="portfolio-image" src="https://placehold.co/800x800/222/fff?text=Projeto+5" alt="Imagem do projeto de convite digital">
                    <div class="item-title-block">
                        <h2>CONVI<br>TE<br>DIGITAL</h2>
                        <p>2025</p>
                    </div>
                </div>
            </div>
        </a>

        <a href="#" class="grid-item-link" data-project="6">
            <div class="grid-item revealable">
                <div class="grid-item-content">
                    <!-- IMAGE ADDED HERE -->
                    <img class="portfolio-image" src="https://placehold.co/800x800/444/fff?text=Projeto+6" alt="Imagem do projeto de convite digital 2">
                    <div class="item-title-block">
                        <h2>CONVI<br>TE<br>DIGITAL</h2>
                        <p>2025</p>
                    </div>
                </div>
            </div>
        </a>

    </main>
  </section>

  <section id="sobre-contato" class="content-hidden">
    <div class="container">
        <main class="content">
            <section id="sobre" class="about revealable">
                <h2 class="section-title">SOBRE</h2>
                <p>
                    Me chamo Matheus Ventura, designer de 19 anos, apaixonado por criar desde cedo. Sempre tive o design e a programação como hobby, experimentando, errando e aprendendo no caminho.
                </p>
                <p>
                    Agora transformo essa paixão em trabalho: explorar ideias, testar formatos e dar vida a projetos que conectam pessoas. Gosto de criar artes simples, mas cheias de personalidade, sempre buscando aprender mais e evoluir a cada projeto.
                </p>
            </section>

            <section id="contato" class="contact revealable">
                <h2 class="section-title">CONTATO</h2>
                <div class="social-icons">
                    <a href="https://instagram.com/user.vnts" target="_blank" aria-label="Instagram"><i data-feather="instagram"></i></a>
                    <a href="https://wa.me/5522996191996" target="_blank" aria-label="Telefone"><i data-feather="phone"></i></a>
                </div>
                <a href="mailto:mvnts@pm.me" class="email">mvnts@pm.me</a>
            </section>
        </main>
    </div>
  </section>

  <footer>
    <div class="back-to-top">
        <a href="#" aria-label="Voltar ao topo">
            <i data-feather="arrow-up-circle"></i>
        </a>
    </div>
    <button id="theme-toggle" class="theme-toggle" aria-label="Alternar tema">
        Mudar Tema
    </button>
    <p class="credits">desenvolvido por <a href="#">vdesigner</a></p>
  </footer>

  <!-- Case Study Modal -->
  <div id="case-study-modal">
      <div class="modal-header">
          <button class="close-modal" aria-label="Fechar"><i data-feather="x"></i></button>
      </div>
      <button class="modal-nav-btn modal-prev" aria-label="Anterior"><i data-feather="chevron-left"></i></button>
      <button class="modal-nav-btn modal-next" aria-label="Próximo"><i data-feather="chevron-right"></i></button>
      <div class="modal-slider" id="modal-slider-content">
          <!-- Images will be injected here via JS -->
      </div>
  </div>

  <script>
    feather.replace();

    window.addEventListener('load', () => {
        const preloader = document.getElementById('preloader');
        const heroSection = document.getElementById('hero-section');
        const servicosSection = document.getElementById('servicos');
        const destaquesSection = document.getElementById('destaques');
        const sobreContatoSection = document.getElementById('sobre-contato');
        const grid = document.querySelector('#hero-section .grid');
        const scrollDownIcon = document.querySelector('.scroll-down');
        const loaderText = document.querySelector('.loader-text');

        function startTransition() {
            setTimeout(() => {
                preloader.style.opacity = '0';
                setTimeout(() => {
                    preloader.style.display = 'none';
                    
                    // Reveal content (it was already loaded in background)
                    heroSection.classList.remove('content-hidden');
                    servicosSection.classList.remove('content-hidden');
                    destaquesSection.classList.remove('content-hidden');
                    sobreContatoSection.classList.remove('content-hidden');
                    
                    document.body.style.overflow = 'auto'; // Allow scrolling
                    
                    setTimeout(() => {
                        grid.classList.add('visible');
                        scrollDownIcon.classList.add('visible');
                    }, 20);

                }, 700);
            }, 500);
        }

        // --- Decoding Text Effect (Underground Style) ---
        const finalMessage = "DÊ VIDA ÀS SUAS IDEIAS";
        const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@#$%&";
        let iterations = 0;
        
        // Initial random text
        loaderText.innerText = finalMessage.split('').map(() => chars[Math.floor(Math.random() * chars.length)]).join('');

        const interval = setInterval(() => {
            loaderText.innerText = finalMessage
                .split("")
                .map((letter, index) => {
                    if (index < iterations) {
                        return finalMessage[index];
                    }
                    return chars[Math.floor(Math.random() * chars.length)];
                })
                .join("");

            if (iterations >= finalMessage.length) {
                clearInterval(interval);
                // Add glitch class after decoding
                loaderText.classList.add('glitch');
                // Start site transition shortly after
                setTimeout(startTransition, 800); 
            }

            iterations += 1 / 2; // Speed of decoding
        }, 50);


        // --- Interactive Marquee Logic ---
        const marqueeContent = document.querySelector('.marquee-content');
        const baseText = marqueeContent.querySelector('span').innerText;
        // Duplicate text enough times to fill screen + buffer
        const repeatCount = 10; 
        marqueeContent.innerHTML = baseText.repeat(repeatCount);

        let marqueePos = 0;
        let marqueeSpeed = 1.5; // Base speed
        let marqueeDirection = -1; // -1 = left, 1 = right
        let marqueeBoost = 0;

        function animateMarquee() {
            // Friction to slow down boost
            marqueeBoost *= 0.92;
            if (Math.abs(marqueeBoost) < 0.1) marqueeBoost = 0;

            // Calculate total speed
            // If boost is high enough, it dictates direction
            if (marqueeBoost > 0.5) marqueeDirection = 1;
            if (marqueeBoost < -0.5) marqueeDirection = -1;

            const currentSpeed = (marqueeSpeed + Math.abs(marqueeBoost)) * marqueeDirection;
            marqueePos += currentSpeed;

            // Infinite Loop Logic
            const contentWidth = marqueeContent.scrollWidth / 2; // Assuming we have enough duplicates
            
            // If moving left
            if (marqueePos <= -contentWidth) {
                marqueePos += contentWidth;
            }
            // If moving right
            if (marqueePos > 0) {
                marqueePos -= contentWidth;
            }

            marqueeContent.style.transform = `translateX(${marqueePos}px)`;
            requestAnimationFrame(animateMarquee);
        }

        animateMarquee();

        // Desktop Wheel Interaction
        const marqueeContainer = document.querySelector('.marquee-container');
        marqueeContainer.addEventListener('wheel', (e) => {
            // e.deltaY usually vertical scroll, but we use it to boost horizontal speed
            // 10x multiplier for "fast" feel
            marqueeBoost += e.deltaY * -0.15; 
        }, { passive: true });

        // Mobile Touch Interaction
        let touchStartX = 0;
        let touchLastX = 0;

        marqueeContainer.addEventListener('touchstart', (e) => {
            touchStartX = e.touches[0].clientX;
            touchLastX = touchStartX;
        }, { passive: true });

        marqueeContainer.addEventListener('touchmove', (e) => {
            const touchCurrentX = e.touches[0].clientX;
            const deltaX = touchCurrentX - touchLastX;
            
            // Boost based on drag speed
            marqueeBoost += deltaX * 0.8;
            
            touchLastX = touchCurrentX;
        }, { passive: true });

        // --- Scroll Reveal Logic ---
        const observerOptions = {
            root: null, // relative to the viewport
            rootMargin: '0px',
            threshold: 0.1 // trigger when 10% of the element is visible
        };

        const observerCallback = (entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('is-visible');
                } else {
                    // This makes the animation reset when scrolling up
                    entry.target.classList.remove('is-visible');
                }
            });
        };

        const observer = new IntersectionObserver(observerCallback, observerOptions);

        const elementsToReveal = document.querySelectorAll('.revealable');
        elementsToReveal.forEach(el => {
            observer.observe(el);
        });

        // --- Custom Cursor Logic ---
        const cursor = document.getElementById('custom-cursor');
        const hoverables = document.querySelectorAll('a, .grid-item-link');

        let mouseX = 0;
        let mouseY = 0;
        let cursorX = 0;
        let cursorY = 0;
        const speed = 0.1;

        document.addEventListener('mousemove', e => {
            mouseX = e.clientX;
            mouseY = e.clientY;
        });

        function animateCursor() {
            const distX = mouseX - cursorX;
            const distY = mouseY - cursorY;

            cursorX += distX * speed;
            cursorY += distY * speed;

            cursor.style.left = cursorX + 'px';
            cursor.style.top = cursorY + 'px';

            requestAnimationFrame(animateCursor);
        }

        animateCursor();

        hoverables.forEach(el => {
            el.addEventListener('mouseenter', () => {
                cursor.classList.add('hover');
            });
            el.addEventListener('mouseleave', () => {
                cursor.classList.remove('hover');
            });
        });

        // --- Parallax Effect for Background Logo ---
        const bgLogoImg = document.querySelector('.bg-logo img');
        let lastScrollY = window.scrollY;

        function updateParallax() {
            const scrollY = window.scrollY;
            const parallaxSpeed = 0.5; // Adjust for desired effect
            const translateY = scrollY * parallaxSpeed;
            bgLogoImg.style.transform = `translate(2%, calc(-4% + ${translateY}px))`;
            lastScrollY = scrollY;
            requestAnimationFrame(updateParallax);
        }

        updateParallax();

        // --- Floating Logo Trigger ---
        setTimeout(() => {
            const brandLogo = document.querySelector('.brand-logo');
            if(brandLogo) brandLogo.classList.add('floating');
        }, 2500);

        // --- Scroll Down Fade Out ---
        window.addEventListener('scroll', () => {
            if (window.scrollY > 50) {
                scrollDownIcon.style.opacity = '0';
                scrollDownIcon.style.pointerEvents = 'none';
            } else {
                // Only show if the intro animation has finished
                if (grid.classList.contains('visible')) {
                    scrollDownIcon.style.opacity = '1';
                    scrollDownIcon.style.pointerEvents = 'auto';
                }
            }
        });

        // --- Draggable Logo Logic ---
        const logoWrapper = document.getElementById('draggable-logo');
        let isDragging = false;
        let startX, startY, initialLeft, initialTop;
        let isFixed = false;
        let resetTimer = null;
        let placeholder = null;
        let originalParent = null;
        let nextSibling = null;

        function startDrag(e) {
            e.preventDefault(); // Prevent default browser drag behavior (ghost image)

            // Cancela o reset se o usuário pegar a logo novamente
            if (resetTimer) {
                clearTimeout(resetTimer);
                resetTimer = null;
            }
            logoWrapper.style.transition = 'none'; // Remove transição para arrasto instantâneo

            const clientX = e.type.includes('mouse') ? e.clientX : e.touches[0].clientX;
            const clientY = e.type.includes('mouse') ? e.clientY : e.touches[0].clientY;

            // "Pop" the logo out of the layout on first interaction
            if (!isFixed) {
                const rect = logoWrapper.getBoundingClientRect();
                
                // Save original context
                originalParent = logoWrapper.parentNode;
                nextSibling = logoWrapper.nextSibling;

                // Create a placeholder to prevent layout shift
                placeholder = document.createElement('div');
                placeholder.style.width = rect.width + 'px';
                placeholder.style.height = rect.height + 'px';
                placeholder.style.display = 'inline-block'; // Match wrapper display
                originalParent.insertBefore(placeholder, logoWrapper);

                // Move to body to escape transform contexts (fixes teleport issue)
                document.body.appendChild(logoWrapper);

                // Set fixed position to allow free movement
                logoWrapper.style.position = 'fixed';
                logoWrapper.style.left = rect.left + 'px';
                logoWrapper.style.top = rect.top + 'px';
                logoWrapper.style.width = rect.width + 'px';
                logoWrapper.style.height = rect.height + 'px';
                logoWrapper.style.zIndex = '10001';
                logoWrapper.style.margin = '0';
                
                isFixed = true;
            }

            logoWrapper.classList.add('active');
            // Add a "pop" effect via transform
            logoWrapper.style.transform = 'scale(1.05)';

            isDragging = true;
            startX = clientX;
            startY = clientY;
            
            // Read current left/top (which we just set)
            initialLeft = parseFloat(logoWrapper.style.left);
            initialTop = parseFloat(logoWrapper.style.top);

            document.addEventListener('mousemove', drag);
            document.addEventListener('touchmove', drag, {passive: false});
            document.addEventListener('mouseup', stopDrag);
            document.addEventListener('touchend', stopDrag);
        }

        function drag(e) {
            if (!isDragging) return;
            e.preventDefault(); // Prevent scrolling
            const clientX = e.type.includes('mouse') ? e.clientX : e.touches[0].clientX;
            const clientY = e.type.includes('mouse') ? e.clientY : e.touches[0].clientY;
            const dx = clientX - startX;
            const dy = clientY - startY;
            logoWrapper.style.left = (initialLeft + dx) + 'px';
            logoWrapper.style.top = (initialTop + dy) + 'px';
        }

        function stopDrag() {
            isDragging = false;
            logoWrapper.classList.remove('active'); // Remove o contorno ao soltar
            logoWrapper.style.transform = ''; // Remove pop scale
            document.removeEventListener('mousemove', drag);
            document.removeEventListener('touchmove', drag);
            document.removeEventListener('mouseup', stopDrag);
            document.removeEventListener('touchend', stopDrag);

            // Inicia contagem para voltar ao lugar
            resetTimer = setTimeout(returnToOrigin, 3000);
        }

        function returnToOrigin() {
            if (!isFixed || !placeholder) return;

            const rect = placeholder.getBoundingClientRect();
            
            // Animação suave de volta
            logoWrapper.style.transition = 'left 0.8s cubic-bezier(0.2, 0.8, 0.2, 1), top 0.8s cubic-bezier(0.2, 0.8, 0.2, 1)';
            logoWrapper.style.left = rect.left + 'px';
            logoWrapper.style.top = rect.top + 'px';

            logoWrapper.addEventListener('transitionend', function cleanup() {
                if (!isDragging && isFixed) { // Garante que o usuário não pegou de novo durante a animação
                    // Move back to original DOM position
                    if (originalParent && placeholder.parentNode === originalParent) {
                        originalParent.insertBefore(logoWrapper, placeholder);
                    } else {
                        placeholder.parentNode.insertBefore(logoWrapper, placeholder);
                    }

                    logoWrapper.style.position = '';
                    logoWrapper.style.left = '';
                    logoWrapper.style.top = '';
                    logoWrapper.style.width = '';
                    logoWrapper.style.height = '';
                    logoWrapper.style.zIndex = '';
                    logoWrapper.style.margin = '';
                    logoWrapper.style.transition = '';
                    logoWrapper.style.transform = '';
                    
                    placeholder.remove();
                    placeholder = null;
                    isFixed = false;
                }
            }, { once: true });
        }

        logoWrapper.addEventListener('mousedown', startDrag);
        logoWrapper.addEventListener('touchstart', startDrag, {passive: false});

        // Remove active state when clicking outside
        document.addEventListener('mousedown', (e) => {
            if (isFixed && !logoWrapper.contains(e.target)) {
                logoWrapper.classList.remove('active');
            }
        });
        document.addEventListener('touchstart', (e) => {
            if (isFixed && !logoWrapper.contains(e.target)) {
                logoWrapper.classList.remove('active');
            }
        });

        // --- Extra: Magnetic Buttons Effect ---
        const magneticBtns = document.querySelectorAll('.menu a, .social-icons a, .back-to-top a');
        magneticBtns.forEach(btn => {
            btn.addEventListener('mousemove', (e) => {
                const rect = btn.getBoundingClientRect();
                const x = e.clientX - rect.left - rect.width / 2;
                const y = e.clientY - rect.top - rect.height / 2;
                // Move o botão levemente em direção ao mouse
                btn.style.transform = `translate(${x * 0.3}px, ${y * 0.3}px)`;
                btn.style.transition = 'transform 0.1s ease-out';
            });
            btn.addEventListener('mouseleave', () => {
                btn.style.transform = 'translate(0, 0)';
                btn.style.transition = 'transform 0.5s cubic-bezier(0.2, 0.8, 0.2, 1)';
            });
        });

        // --- Extra: 3D Tilt Effect on Services ---
        const cards = document.querySelectorAll('#servicos .card');
        cards.forEach(card => {
            card.addEventListener('mousemove', (e) => {
                const rect = card.getBoundingClientRect();
                const x = e.clientX - rect.left - rect.width / 2;
                const y = e.clientY - rect.top - rect.height / 2;
                // Inclina o card baseado na posição do mouse
                card.style.transform = `perspective(1000px) rotateX(${-y * 0.02}deg) rotateY(${x * 0.02}deg) translateY(-12px)`;
            });
            card.addEventListener('mouseleave', () => {
                card.style.transform = ''; // Volta ao estado normal (definido no CSS hover)
            });
        });

        // --- Dark Mode Toggle ---
        const themeToggles = document.querySelectorAll('#theme-toggle, #hero-theme-toggle');
        const brandLogo = document.querySelector('.brand-logo');
        const bgLogo = document.querySelector('.bg-logo img');
        const themeTransitionOverlay = document.getElementById('theme-transition-overlay');

        function toggleTheme(e) {
            if(e) e.preventDefault();
            
            // 1. Show Overlay
            themeTransitionOverlay.classList.add('active');

            // 2. Wait for fade in
            setTimeout(() => {
                // 3. Wait 1s loading
                setTimeout(() => {
                    // 4. Actual Toggle
                    document.body.classList.toggle('dark-mode');
                    const isDark = document.body.classList.contains('dark-mode');

                    // Swap Logos
                    const newSrc = isDark ? 'profilepicpngwhite.png' : 'profilepicpng.png';
                    if(brandLogo) brandLogo.src = newSrc;
                    if(bgLogo) bgLogo.src = newSrc;

                    // 5. Hide Overlay
                    themeTransitionOverlay.classList.remove('active');

                }, 1000);
            }, 500);
        }

        themeToggles.forEach(btn => {
            btn.addEventListener('click', toggleTheme);
        });

        // --- Case Study Modal Logic ---
        const modal = document.getElementById('case-study-modal');
        const closeModalBtn = document.querySelector('.close-modal');
        const sliderContent = document.getElementById('modal-slider-content');
        const projectLinks = document.querySelectorAll('.grid-item-link');
        const prevBtn = document.querySelector('.modal-prev');
        const nextBtn = document.querySelector('.modal-next');
        let slideObserver = null;

        projectLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                openModal();
            });
        });

        closeModalBtn.addEventListener('click', closeModal);
        
        // Navigation Logic
        prevBtn.addEventListener('click', () => {
            sliderContent.scrollBy({ left: -window.innerWidth, behavior: 'smooth' });
        });
        nextBtn.addEventListener('click', () => {
            sliderContent.scrollBy({ left: window.innerWidth, behavior: 'smooth' });
        });
        
        // Hover effect for nav buttons using custom cursor
        [prevBtn, nextBtn, closeModalBtn].forEach(btn => {
            btn.addEventListener('mouseenter', () => document.getElementById('custom-cursor').classList.add('hover'));
            btn.addEventListener('mouseleave', () => document.getElementById('custom-cursor').classList.remove('hover'));
        });

        function openModal() {
            // Populate with 9 placeholder images representing the process
            sliderContent.innerHTML = '';
            for (let i = 1; i <= 9; i++) {
                const slide = document.createElement('div');
                slide.classList.add('slide');
                
                const img = document.createElement('img');
                // Using placeholders. In real usage, you'd use an array of real URLs based on the project ID
                let text = i.toString(); // Apenas números
                
                img.src = `https://placehold.co/1920x1080/222/fff?text=${encodeURIComponent(text)}`;
                img.alt = text;
                
                slide.appendChild(img);

                // Caption (Underground Style)
                const caption = document.createElement('div');
                caption.classList.add('slide-caption');
                caption.innerHTML = `<h3>PROJETO ${i}</h3><br><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Estilo underground.</p>`;
                slide.appendChild(caption);

                sliderContent.appendChild(slide);
            }

            modal.classList.add('active');
            document.body.style.overflow = 'hidden'; // Prevent background scrolling
            
            // Setup Observer for Slide Animations
            if (slideObserver) slideObserver.disconnect();
            
            const options = {
                root: sliderContent,
                threshold: 0.5
            };
            
            slideObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('active');
                    } else {
                        entry.target.classList.remove('active');
                    }
                });
            }, options);
            
            document.querySelectorAll('.slide').forEach(slide => {
                slideObserver.observe(slide);
            });
        }

        function closeModal() {
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
            if (slideObserver) slideObserver.disconnect();
        }

    });
  </script>

</body>
</html>
